<!doctype html>
<html lang="en" data-layout="vertical" data-topbar="light" data-sidebar="dark" data-sidebar-size="lg" data-sidebar-image="none" data-preloader="disable">
<head>
    <meta charset="utf-8" />
    <title>Restaurant Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Restaurant Management Dashboard" name="description" />
    <!-- App favicon -->
    <link rel="shortcut icon" href="/assets/imgs/logo/restau.png">

    <!-- Layout config Js -->
    <script src="/asset/js/layout.js"></script>
    <!-- Bootstrap Css -->
    <link href="/asset/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <!-- Icons Css -->
    <link href="/asset/css/icons.min.css" rel="stylesheet" type="text/css" />
    <!-- App Css-->
    <link href="/asset/css/app.min.css" rel="stylesheet" type="text/css" />
    <!-- custom Css-->
    <link href="/asset/css/custom.min.css" rel="stylesheet" type="text/css" />

</head>


    <!-- Begin page -->
    <div id="layout-wrapper">
        <header id="page-topbar">
            <div class="layout-width">
                <div class="navbar-header">
                    <div class="d-flex">
                        <button type="button" class="btn btn-sm px-3 fs-16 header-item vertical-menu-btn topnav-hamburger" id="topnav-hamburger-icon">
                           
                        </button>

                        <!-- App Search-->
                        <form class="app-search d-none d-md-block">
                            
                        </form>
                    </div>

                    <div class="d-flex align-items-center">
                        <!-- Mobile search -->
                        

<!-- Notifications dropdown -->
<div class="dropdown d-inline-block">
  <button type="button" class="btn header-item noti-icon position-relative" 
          id="page-header-notifications-dropdown"
          data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    <i class="bx bx-bell fs-20"></i>
    <span *ngIf="unreadCount > 0" 
          class="badge bg-danger rounded-pill position-absolute"
          style="top: -2px; right: -6px; font-size: 10px; min-width: 16px; height: 16px; line-height: 16px;">
      {{ unreadCount > 99 ? '99+' : unreadCount }}
    </span>
  </button>

  <!-- Menu déroulant des notifications -->
  <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end p-0" 
       aria-labelledby="page-header-notifications-dropdown">
    
    <!-- Header du dropdown -->
    <div class="dropdown-head bg-primary bg-pattern rounded-top">
      <div class="p-3">
        <div class="row align-items-center">
          <div class="col">
            <h6 class="m-0 fs-16 fw-semibold text-white">Notifications</h6>
          </div>
          <div class="col-auto dropdown-tabs">
            <span class="badge bg-light-subtle text-body fs-13">
              {{ unreadCount }} Nouvelle{{ unreadCount !== 1 ? 's' : '' }}
            </span>
          </div>
        </div>
      </div>

      <!-- Actions rapides -->
      <div class="px-2 pt-0 pb-2" *ngIf="notifications.length > 0">
        <div class="d-flex gap-1">
          <button type="button" 
                  class="btn btn-link btn-sm text-white p-1"
                  (click)="markAllAsRead()"
                  title="Marquer tout comme lu">
            <i class="bx bx-check-double fs-16"></i>
          </button>
          <button type="button" 
                  class="btn btn-link btn-sm text-white p-1"
                  (click)="clearAllNotifications()"
                  title="Supprimer toutes les notifications">
            <i class="bx bx-trash fs-16"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Contenu des notifications -->
    <div class="tab-content position-relative" id="notificationItemsTabContent">
      <div class="tab-pane fade show active py-2 ps-2" id="all-noti-tab" role="tabpanel">
        <div data-simplebar style="max-height: 400px;" class="pe-2">
          
          <!-- Message si aucune notification -->
          <div *ngIf="displayedNotifications.length === 0" class="text-center py-4">
            <div class="avatar-md mx-auto mb-3">
              <div class="avatar-title bg-light text-muted rounded-circle fs-20">
                <i class="bx bx-bell-off"></i>
              </div>
            </div>
            <p class="text-muted mb-0">Aucune notification</p>
          </div>

          <!-- Liste des notifications (limitée à 2) -->
          <div *ngFor="let notif of displayedNotifications; let i = index" 
               class="text-reset notification-item d-block dropdown-item position-relative"
               [class.unread]="!notif.read"
               (click)="markAsRead(notif.id)">
            
            <div class="d-flex align-items-start">
              <!-- Icône de la notification -->
              <div class="avatar-xs me-3 flex-shrink-0">
                <span class="avatar-title rounded-circle fs-16" 
                      [ngClass]="getNotificationColor(notif.type)">
                  <i [ngClass]="getNotificationIcon(notif.type)"></i>
                </span>
              </div>

              <!-- Contenu de la notification -->
              <div class="flex-grow-1 min-width-0">
                <!-- Titre -->
                <h6 class="mt-0 mb-1 lh-base fw-semibold" 
                    [class.text-primary]="!notif.read">
                  {{ getNotificationTitle(notif) }}
                </h6>
                
                <!-- Message principal -->
                <p class="mb-1 text-muted lh-base" 
                   [class.fw-medium]="!notif.read">
                  {{ notif.message }}
                </p>
                
                <!-- Détails supplémentaires pour les réservations -->
                <div *ngIf="notif.type === 'reservation' && notif.details" 
                     class="mb-1">
                  <small class="text-info">
                    <i class="bx bx-group me-1"></i>
                    {{ notif.details.persons }} personne{{ notif.details.persons > 1 ? 's' : '' }}
                    <span *ngIf="notif.table"> - Table: {{ notif.table }}</span>
                    <span *ngIf="notif.details.phone"> - Tél: {{ notif.details.phone }}</span>
                  </small>
                </div>
                
                <!-- Message du client pour les réservations -->
                <div *ngIf="notif.type === 'reservation' && notif.clientMessage" 
                     class="mb-1 p-2 bg-light rounded">
                  <small class="text-muted">
                    <i class="bx bx-message-dots me-1"></i>
                    <strong>Message:</strong> "{{ notif.clientMessage }}"
                  </small>
                </div>
                
                <!-- Timestamp -->
                <p class="mb-0 fs-11 fw-medium text-uppercase text-muted">
                  <i class="mdi mdi-clock-outline me-1"></i>
                  {{ formatTime(notif.timestamp) }}
                </p>
              </div>

              <!-- Actions et indicateurs -->
              <div class="flex-shrink-0 ms-2">
                <!-- Bouton supprimer -->
                <button type="button" 
                        class="btn btn-sm btn-link text-muted p-1"
                        (click)="removeNotification(notif.id, $event)"
                        title="Supprimer">
                  <i class="bx bx-x fs-16"></i>
                </button>
                
                <!-- Indicateur non lu -->
                <div *ngIf="!notif.read" class="mt-1">
                  <span class="badge bg-primary rounded-pill fs-11">Nouveau</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Indicateur pour les notifications cachées -->
          <div *ngIf="hiddenNotificationsCount > 0" 
               class="text-center py-2 border-top">
            <small class="text-muted">
              <i class="bx bx-dots-horizontal-rounded me-1"></i>
              {{ hiddenNotificationsCount }} notification{{ hiddenNotificationsCount > 1 ? 's' : '' }} supplémentaire{{ hiddenNotificationsCount > 1 ? 's' : '' }}
            </small>
          </div>

          <!-- Footer avec actions -->
          <div *ngIf="notifications.length > 0" class="my-3 text-center view-all border-top pt-3">
            <div class="d-flex gap-2 justify-content-center">
              <button type="button" 
                      class="btn btn-soft-primary btn-sm waves-effect waves-light"
                      (click)="openModal()">
                <i class="bx bx-list-ul me-1"></i>
                Voir toutes ({{ notifications.length }})
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal utilisant l'API native dialog -->
<dialog #allNotificationsModal class="modal-dialog">
  <div class="modal-content">
    <!-- Header de la modal -->
    <div class="modal-header bg-primary">
      <h5 class="modal-title text-white">
        <i class="bx bx-bell me-2"></i>
        Toutes les notifications
      </h5>
      <button type="button" class="btn-close btn-close-white" (click)="closeModal()" aria-label="Close"></button>
    </div>

    <!-- Sous-header avec statistiques et actions -->
    <div class="modal-header bg-light border-bottom">
      <div class="d-flex w-100 justify-content-between align-items-center">
        <div class="d-flex gap-3">
          <span class="badge bg-primary fs-12">
            Total: {{ notifications.length }}
          </span>
          <span class="badge bg-warning fs-12" *ngIf="unreadCount > 0">
            Non lues: {{ unreadCount }}
          </span>
        </div>
        
        <div class="d-flex gap-2">
          <button type="button" 
                  class="btn btn-sm btn-outline-success"
                  (click)="handleModalAction('markAllAsRead')"
                  [disabled]="unreadCount === 0"
                  title="Marquer tout comme lu">
            <i class="bx bx-check-double me-1"></i>
            Marquer tout comme lu
          </button>
          <button type="button" 
                  class="btn btn-sm btn-outline-danger"
                  (click)="handleModalAction('clearAll')"
                  [disabled]="notifications.length === 0"
                  title="Supprimer toutes">
            <i class="bx bx-trash me-1"></i>
            Supprimer tout
          </button>
        </div>
      </div>
    </div>

    <!-- Filtres -->
    <div class="modal-header bg-light border-bottom">
      <div class="d-flex gap-2 w-100">
        <select class="form-select form-select-sm" 
                [(ngModel)]="selectedFilter" 
                (change)="applyFilter()">
          <option value="all">Toutes les notifications</option>
          <option value="unread">Non lues seulement</option>
          <option value="reservation">Réservations</option>
          <option value="info">Informations</option>
          <option value="warning">Avertissements</option>
          <option value="error">Erreurs</option>
        </select>
        
        <select class="form-select form-select-sm" 
                [(ngModel)]="selectedSort" 
                (change)="applySorting()">
          <option value="newest">Plus récentes</option>
          <option value="oldest">Plus anciennes</option>
          <option value="unread-first">Non lues en premier</option>
        </select>
      </div>
    </div>
    
    <!-- Corps de la modal -->
    <div class="modal-body p-0" style="max-height: 60vh; overflow-y: auto;">
      <!-- Message si aucune notification -->
      <div *ngIf="filteredNotifications.length === 0" class="text-center py-5">
        <div class="avatar-lg mx-auto mb-4">
          <div class="avatar-title bg-light text-muted rounded-circle fs-24">
            <i class="bx bx-bell-off"></i>
          </div>
        </div>
        <h6 class="text-muted">Aucune notification</h6>
        <p class="text-muted mb-0 small">
          {{ selectedFilter !== 'all' ? 'Aucune notification ne correspond aux filtres sélectionnés.' : 'Vous êtes à jour !' }}
        </p>
      </div>

      <!-- Liste des notifications -->
      <div class="list-group list-group-flush">
        <div *ngFor="let notif of filteredNotifications; let i = index; trackBy: trackByNotificationId" 
             class="list-group-item list-group-item-action notification-item"
             [class.list-group-item-light]="!notif.read"
             [class.border-start-primary]="!notif.read"
             style="border-left-width: 4px !important; cursor: pointer;"
             (click)="handleModalAction('markAsRead', notif.id)">
          
          <div class="d-flex align-items-start">
            <div class="avatar-sm me-3 flex-shrink-0">
              <span class="avatar-title rounded-circle fs-18" 
                    [ngClass]="getNotificationColor(notif.type)">
                <i [ngClass]="getNotificationIcon(notif.type)"></i>
              </span>
            </div>

            <div class="flex-grow-1 min-width-0">
              <div class="d-flex justify-content-between align-items-start mb-1">
                <h6 class="mb-0 fw-semibold" 
                    [class.text-primary]="!notif.read">
                  {{ getNotificationTitle(notif) }}
                </h6>
                <small class="text-muted ms-2 flex-shrink-0">
                  {{ formatTime(notif.timestamp) }}
                </small>
              </div>
              
              <p class="mb-2 text-muted lh-sm" 
                 [class.fw-medium]="!notif.read">
                {{ notif.message }}
              </p>
              
              <div *ngIf="notif.type === 'reservation' && notif.details" 
                   class="mb-2">
                <div class="row g-2">
                  <div class="col-auto">
                    <span class="badge bg-info-subtle text-info">
                      <i class="bx bx-group me-1"></i>
                      {{ notif.details.persons }} personne{{ notif.details.persons > 1 ? 's' : '' }}
                    </span>
                  </div>
                  <div class="col-auto" *ngIf="notif.table">
                    <span class="badge bg-secondary-subtle text-secondary">
                      <i class="bx bx-table me-1"></i>
                      Table {{ notif.table }}
                    </span>
                  </div>
                  <div class="col-auto" *ngIf="notif.details.phone">
                    <span class="badge bg-primary-subtle text-primary">
                      <i class="bx bx-phone me-1"></i>
                      {{ notif.details.phone }}
                    </span>
                  </div>
                </div>
              </div>
              
              <div *ngIf="notif.type === 'reservation' && notif.clientMessage" 
                   class="alert alert-info alert-sm mb-2 py-2">
                <i class="bx bx-message-dots me-2"></i>
                <strong>Message client:</strong> "{{ notif.clientMessage }}"
              </div>
              
              <div class="d-flex gap-2 mt-2">
                <button *ngIf="!notif.read" 
                        type="button" 
                        class="btn btn-sm btn-outline-primary"
                        (click)="handleModalAction('markAsRead', notif.id, $event)">
                  <i class="bx bx-check me-1"></i>
                  Marquer comme lu
                </button>
                
                <button type="button" 
                        class="btn btn-sm btn-outline-danger"
                        (click)="handleModalAction('remove', notif.id, $event)">
                  <i class="bx bx-trash me-1"></i>
                  Supprimer
                </button>
                
                <button *ngIf="notif.type === 'reservation'" 
                        type="button" 
                        class="btn btn-sm btn-outline-success"
                        (click)="handleModalAction('viewDetails', notif.id, $event)">
                  <i class="bx bx-show me-1"></i>
                  Voir détails
                </button>
              </div>
            </div>

            <div *ngIf="!notif.read" class="flex-shrink-0 ms-2">
              <span class="badge bg-primary rounded-pill">Nouveau</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer bg-light" *ngIf="filteredNotifications.length > 0">
      <div class="d-flex w-100 justify-content-between align-items-center">
        <small class="text-muted">
          Affichage de {{ filteredNotifications.length }} notification{{ filteredNotifications.length > 1 ? 's' : '' }}
        </small>
        
        <div class="d-flex gap-2">
          <button type="button" 
                  class="btn btn-light btn-sm"
                  (click)="closeModal()">
            Fermer
          </button>
        </div>
      </div>
    </div>
  </div>
</dialog>
                        <!-- User profile dropdown -->
                        <div class="dropdown ms-sm-3 header-item topbar-user">
                            <button type="button" class="btn" id="page-header-user-dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="d-flex align-items-center">
                                    <span class="text-start ms-xl-2">
                                        <span class="d-none d-xl-inline-block ms-1 fw-medium user-name-text">Administrateur</span>
                                        <span class="d-none d-xl-block ms-1 fs-12 user-name-sub-text"> Bienvenue {{ username }} ! </span>
                                      
                                    </span>
                                </span>
                            </button>
                            <div class="dropdown-menu dropdown-menu-end">
                                <!-- item-->
                                <h6 class="dropdown-header">Mon compte</h6>
                                <a class="dropdown-item" routerLink="/profil"><i class="mdi mdi-account-circle text-muted fs-16 align-middle me-1"></i> <span class="align-middle">Profil</span></a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" (click)="onLogout()"><i class="mdi mdi-logout text-muted fs-16 align-middle me-1"></i> <span class="align-middle">Déconnexion</span></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- removeNotificationModal -->
        <div id="removeNotificationModal" class="modal fade zoomIn" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="NotificationModalbtn-close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mt-2 text-center">
                            <div class="mt-4 pt-2 fs-15 mx-4 mx-sm-5">
                                <h4>Are you sure?</h4>
                                <p class="text-muted mx-4 mb-0">Are you sure you want to remove this Notification?</p>
                            </div>
                        </div>
                        <div class="d-flex gap-2 justify-content-center mt-4 mb-2">
                            <button type="button" class="btn w-sm btn-light" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn w-sm btn-danger" id="delete-notification">Yes, Delete It!</button>
                        </div>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div>

        <!-- ========== App Menu ========== -->
        <div class="app-menu navbar-menu">
            <!-- LOGO -->
            <div class="navbar-brand-box">
                <a routerLink="/dashboard" class="logo logo-dark">
                    <span class="logo-sm">
                        <img src="/assets/imgs/logo/restau.png" alt="Restaurant Logo" height="28">
                    </span>
                    <span class="logo-lg">
                        <img src="/assets/imgs/logo/restau.png" alt="Restaurant Logo" height="40">
                    </span>
                </a>
                <a routerLink="/dashboard" class="logo logo-light">
                    <span class="logo-sm">
                        <img src="/assets/imgs/logo/restau.png" alt="Restaurant Logo" height="28">
                    </span>
                    <span class="logo-lg">
                        <img src="/assets/imgs/logo/restau.png" alt="Restaurant Logo" height="40">
                    </span>
                </a>
            </div>

             <div id="scrollbar">
                <div class="container-fluid">
                    <ul class="navbar-nav" id="navbar-nav">
                        <li class="menu-title"><span>MENU</span></li>
                        
                        <!-- Accounts Menu -->
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="#accountsMenu" data-bs-toggle="collapse" role="button" aria-expanded="false">
                                <i class="ri-user-line"></i> <span>Comptes</span>
                            </a>
                            <div class="collapse menu-dropdown" id="accountsMenu">
                                <ul class="nav nav-sm flex-column">
                                
                                    <!-- Customers -->
                                    <li class="nav-item">
                                        <a class="nav-link" href="#customerSubmenu" data-bs-toggle="collapse" role="button" aria-expanded="false">
                                            <span routerLink="/customers">Clients</span>
                                        </a>
                                        <div class="collapse" id="customerSubmenu">
                                            <ul class="nav nav-sm flex-column">
                                                <li class="nav-item"><a  class="nav-link">Ajouter un client</a></li>
                                                <li class="nav-item"><a  class="nav-link">Supprimer un client</a></li>
                                                <li class="nav-item"><a  class="nav-link">Modifier un client</a></li>
                                                <li class="nav-item"><a  class="nav-link">Consulter la liste des clients</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                    
                                    <!-- Delivery Persons -->
                                    <li class="nav-item">
                                        <a class="nav-link" href="#deliveryPersonSubmenu" data-bs-toggle="collapse" role="button" aria-expanded="false">
                                            <span routerLink="/livreurs">Livreurs</span>
                                        </a>

                                        <div class="collapse" id="deliveryPersonSubmenu">
                                            <ul class="nav nav-sm flex-column">
                                                <li class="nav-item"><a  class="nav-link">Ajouter un livreur</a></li>
                                                <li class="nav-item"><a  class="nav-link">Supprimer un livreur</a></li>
                                                <li class="nav-item"><a  class="nav-link">Modifier un livreur</a></li>
                                                <li class="nav-item"><a  class="nav-link">Consulter la liste des livreurs</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        
                        <!-- Dishes Menu -->
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="#dishesMenu" data-bs-toggle="collapse" role="button" aria-expanded="false">
                                <i class="ri-restaurant-line"></i> <span routerLink="/menu">Plats</span>
                            </a>
                            <div class="collapse menu-dropdown" id="dishesMenu">
                                <ul class="nav nav-sm flex-column">
                                    <li class="nav-item"><a  class="nav-link">Ajouter un plat</a></li>
                                    <li class="nav-item"><a  class="nav-link">Supprimer un plat</a></li>
                                    <li class="nav-item"><a  class="nav-link">Modifier un plat</a></li>
                                    <li class="nav-item"><a  class="nav-link">Consulter la liste des plats</a></li>
                                </ul>
                            </div>
                        </li>
                    
                        <!-- Table Menu -->
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="#tableMenu" data-bs-toggle="collapse" role="button" aria-expanded="false">
                                <i class="ri-layout-grid-line"></i> <span routerLink="/table">Tables</span>
                            </a>
                            <div class="collapse menu-dropdown" id="tableMenu">
                                <ul class="nav nav-sm flex-column">
                                    <li class="nav-item"><a  class="nav-link">Ajouter un table</a></li>
                                    <li class="nav-item"><a  class="nav-link">Supprimer un table</a></li>
                                    <li class="nav-item"><a  class="nav-link">Modifier un table</a></li>
                                    <li class="nav-item"><a  class="nav-link">Consulter la liste des tables</a></li>
                                </ul>
                            </div>
                        </li>
                    
                        <!-- Orders Menu -->
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="#orderMenu" data-bs-toggle="collapse" role="button" aria-expanded="false">
                                <i class="ri-shopping-cart-line"></i> <span routerLink="/admin/commande">Commandes</span>
                            </a>
                            <div class="collapse menu-dropdown" id="orderMenu">
                                <ul class="nav nav-sm flex-column">
                                    <li class="nav-item"><a  class="nav-link">Ajouter une commande</a></li>
                                    <li class="nav-item"><a  class="nav-link">Supprimer une commande</a></li>
                                    <li class="nav-item"><a  class="nav-link">Modifier une commande</a></li>
                                    <li class="nav-item"><a  class="nav-link">Consulter la liste des commandes</a></li>
                                </ul>
                            </div>
                        </li>
                    
                        <!-- Reservation Menu -->
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="#reservationMenu" data-bs-toggle="collapse" role="button" aria-expanded="false">
                                <i class="ri-calendar-check-line"></i> <span routerLink="/admin/reservation">Réservations</span>
                            </a>
                            <div class="collapse menu-dropdown" id="reservationMenu">
                                <ul class="nav nav-sm flex-column">
                                    <li class="nav-item"><a  class="nav-link">Ajouter une réservation</a></li>
                                    <li class="nav-item"><a  class="nav-link">Supprimer une réservation</a></li>
                                    <li class="nav-item"><a  class="nav-link">Modifier une réservation</a></li>
                                    <li class="nav-item"><a  class="nav-link">Consulter la liste des réservations</a></li>
                                </ul>
                            </div>
                        </li>
                    
                        <!-- Delivery Menu -->
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="#deliveryMenu" data-bs-toggle="collapse" role="button" aria-expanded="false">
                                <i class="ri-truck-line"></i> <span routerLink="/livraison">Livraisons</span>
                            </a>
                            <div class="collapse menu-dropdown" id="deliveryMenu">
                                <ul class="nav nav-sm flex-column">
                                    <li class="nav-item"><a  class="nav-link">Assigner une livraison à un livreur</a></li>
                                    <li class="nav-item"><a  class="nav-link">Supprimer une livraison</a></li>
                                    <li class="nav-item"><a  class="nav-link">Modifier une livraison</a></li>
                                    <li class="nav-item"><a  class="nav-link">Voir la liste des livraisons</a></li>
                                </ul>
                            </div>
                        </li>

                        
                    </ul>
                </div>
                <!-- Sidebar -->
            </div>
        </div>
        <!-- Left Sidebar End -->
        <div class="vertical-overlay"></div>




       
        <div class="main-content">
            <div class="page-content">

                <div class="aaa">
                    <!-- start page title -->
                    <div class="row">
                        <div class="col-12">
                            <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                                <h4 class="mb-sm-0">Tableau de bord du restaurant</h4>
                                <div class="page-title-right">
                                    <ol class="breadcrumb m-0">
                                        <li class="breadcrumb-item"><a href="accueil">Accueil</a></li>
                                        <li class="breadcrumb-item active"><a href="plat">Plats</a></li>
                                        <li class="breadcrumb-item"><a href="reservation">Réservation</a></li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end page title -->
                
                    <div class="row">
                        <!-- Repeat this card 6 times -->
                        <div class="col-xl-4 col-md-4">
                            <div class="card card-animate">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-grow-1">
                                            <p class="text-uppercase fw-medium text-muted mb-0">Total des comptes</p>
                                        </div>
                                        <div class="flex-shrink-0">
                                            <h5 class="text-success fs-14 mb-0">
                                                <i class="ri-arrow-right-up-line fs-13 align-middle"></i> {{ UserCount }}
                                            </h5>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-end justify-content-between mt-4">
                                        <div>
                                            <h4 class="fs-22 fw-semibold ff-secondary mb-4"></h4>
                                            <a routerLink="/customers"  class="text-decoration-underline">Voir les détails</a>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                
                        <!-- Copy and paste the same card 5 more times below -->
                        <div class="col-xl-4 col-md-4">
                            <div class="card card-animate">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-grow-1">
                                            <p class="text-uppercase fw-medium text-muted mb-0">Total des plats</p>
                                        </div>
<div class="flex-shrink-0">
  <h5 class="text-success fs-14 mb-0">
    <i class="ri-arrow-right-up-line fs-13 align-middle"></i> {{ platCount }}
  </h5>
</div>
                                    </div>
                                    <div class="d-flex align-items-end justify-content-between mt-4">
                                        <div>
                                            <h4 class="fs-22 fw-semibold ff-secondary mb-4"></h4>
                                            <a routerLink="/menu" class="text-decoration-underline">Voir les détails</a>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                
                        <!-- Add 4 more cards here (same structure) -->
                        <div class="col-xl-4 col-md-4">
                            <div class="card card-animate">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-grow-1">
                                            <p class="text-uppercase fw-medium text-muted mb-0">Total des tables</p>
                                        </div>
                                        <div class="flex-shrink-0">
                                            <h5 class="text-success fs-14 mb-0">
                                                <i class="ri-arrow-right-up-line fs-13 align-middle"></i> {{ TablesCount }}
                                            </h5>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-end justify-content-between mt-4">
                                        <div>
                                            <h4 class="fs-22 fw-semibold ff-secondary mb-4"></h4>
                                            <a routerLink="/table"  class="text-decoration-underline">Voir les détails</a>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>





                        <!-- 3 fois-->


                        <div class="col-xl-4 col-md-4">
                            <div class="card card-animate">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-grow-1">
                                            <p class="text-uppercase fw-medium text-muted mb-0">Total des commandes</p>
                                        </div>
                                        <div class="flex-shrink-0">
                                            <h5 class="text-success fs-14 mb-0">
                                                <i class="ri-arrow-right-up-line fs-13 align-middle"></i> {{ commandeCount }}
                                            </h5>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-end justify-content-between mt-4">
                                        <div>
                                            <h4 class="fs-22 fw-semibold ff-secondary mb-4"></h4>
                                            <a routerLink="/admin/commande" class="text-decoration-underline">Voir les détails</a>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>



                        <!-- 2 fois-->



                        <div class="col-xl-4 col-md-4">
                            <div class="card card-animate">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-grow-1">
                                            <p class="text-uppercase fw-medium text-muted mb-0">Total des réservations</p>
                                        </div>
                                        <div class="flex-shrink-0">
                                            <h5 class="text-success fs-14 mb-0">
                                                <i class="ri-arrow-right-up-line fs-13 align-middle"></i> {{ ReservationCount }}
                                            </h5>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-end justify-content-between mt-4">
                                        <div>
                                            <h4 class="fs-22 fw-semibold ff-secondary mb-4"></h4>
                                            <a routerLink="/admin/reservation" class="text-decoration-underline">Voir les détails</a>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>




                        <!-- 1 fois-->



                        <div class="col-xl-4 col-md-4">
                            <div class="card card-animate">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-grow-1">
                                            <p class="text-uppercase fw-medium text-muted mb-0">Total des livraisons</p>
                                        </div>
                                        <div class="flex-shrink-0">
                                            <h5 class="text-success fs-14 mb-0">
                                                <i class="ri-arrow-right-up-line fs-13 align-middle"></i> {{ livraisonCount }}
                                            </h5>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-end justify-content-between mt-4">
                                        <div>
                                            <h4 class="fs-22 fw-semibold ff-secondary mb-4"></h4>
                                            <a routerLink="/livraison" class="text-decoration-underline">Voir les détails</a>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>




            </div>
        </div>   
        
        
       
    </div>      




                                
 <!-- Bouton de chat flottant -->
<div class="chat-button"(click)="openChatModal()" >
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2ZM20 16H5.17L4 17.17V4H20V16Z" fill="white"/>
        <circle cx="8" cy="10" r="1" fill="white"/>
        <circle cx="12" cy="10" r="1" fill="white"/>
        <circle cx="16" cy="10" r="1" fill="white"/>
    </svg>
</div>

    <!-- Composant chat modal -->
    <app-chat 
      [isModalOpen]="isChatModalOpen"
      (closeModal)="closeChatModal()">
    </app-chat>
    <!-- Votre contenu de page existant -->
    <div class="page-content">
      <!-- Contenu de votre page -->
    </div>
<style>
/* Bouton de chat flottant */
.chat-button {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    transition: all 0.3s ease;
    z-index: 1000;
}

.chat-button:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 25px rgba(0,0,0,0.4);
}

/* Modal du chatbot */
.chat-modal {
    display: none;
    position: fixed;
    z-index: 1001;
    right: 30px;
    bottom: 100px;
    width: 350px;
    height: 500px;
    background: white;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    overflow: hidden;
}

.chat-modal-content {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.chat-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.chat-header h3 {
    margin: 0;
    font-size: 1.1rem;
}

.close {
    font-size: 24px;
    cursor: pointer;
    color: white;
    opacity: 0.8;
    transition: opacity 0.3s;
}

.close:hover {
    opacity: 1;
}

.chat-body {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
    background: #f8f9fa;
}

.message {
    margin-bottom: 15px;
    display: flex;
}

.bot-message .message-content {
    background: #e9ecef;
    color: #333;
    padding: 10px 15px;
    border-radius: 18px 18px 18px 5px;
    max-width: 80%;
}

.user-message {
    justify-content: flex-end;
}

.user-message .message-content {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 10px 15px;
    border-radius: 18px 18px 5px 18px;
    max-width: 80%;
}

.chat-footer {
    padding: 15px 20px;
    border-top: 1px solid #e9ecef;
    display: flex;
    gap: 10px;
}

.chat-footer input {
    flex: 1;
    padding: 10px 15px;
    border: 1px solid #ddd;
    border-radius: 25px;
    outline: none;
    font-size: 14px;
}

.chat-footer input:focus {
    border-color: #667eea;
}

.chat-footer button {
    padding: 10px 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    font-size: 14px;
    transition: opacity 0.3s;
}

.chat-footer button:hover {
    opacity: 0.9;
}

/* Animation d'apparition */
.chat-modal.show {
    display: block;
    animation: slideUp 0.3s ease;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Responsive */
@media (max-width: 768px) {
    .chat-modal {
        right: 15px;
        left: 15px;
        width: auto;
        bottom: 90px;
    }
    
    .chat-button {
        right: 20px;
        bottom: 20px;
    }
}
</style>
<script>
function openChatModal() {
    const modal = document.getElementById('chatModal');
    modal.style.display = 'block';
    modal.classList.add('show');
}

function closeChatModal() {
    const modal = document.getElementById('chatModal');
    modal.style.display = 'none';
    modal.classList.remove('show');
}

function sendMessage() {
    const input = document.getElementById('chatInput');
    const message = input.value.trim();
    
    if (message) {
        addMessage(message, 'user');
        input.value = '';
        
        // Simuler une réponse du bot après un délai
        setTimeout(() => {
            const responses = [
                "Merci pour votre message ! Comment puis-je vous aider davantage ?",
                "C'est une excellente question ! Laissez-moi vous aider avec cela.",
                "Je comprends votre demande. Voici ce que je peux vous suggérer...",
                "Parfait ! Je suis là pour vous assister."
            ];
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            addMessage(randomResponse, 'bot');
        }, 1000);
    }
}

function addMessage(text, sender) {
    const chatBody = document.querySelector('.chat-body');
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${sender}-message`;
    
    const contentDiv = document.createElement('div');
    contentDiv.className = 'message-content';
    contentDiv.textContent = text;
    
    messageDiv.appendChild(contentDiv);
    chatBody.appendChild(messageDiv);
    
    // Scroll vers le bas
    chatBody.scrollTop = chatBody.scrollHeight;
}

function handleKeyPress(event) {
    if (event.key === 'Enter') {
        sendMessage();
    }
}

// Fermer le modal en cliquant à l'extérieur
window.onclick = function(event) {
    const modal = document.getElementById('chatModal');
    if (event.target === modal) {
        closeChatModal();
    }
}
</script>
 